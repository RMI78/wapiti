{
    "vulnerabilities": {
        "Backup file": [],
        "Weak credentials": [],
        "CRLF Injection": [],
        "Content Security Policy Configuration": [],
        "Cross Site Request Forgery": [
            {
                "method": "POST",
                "path": "/csrf_verify_unprotected.php",
                "info": "Lack of anti CSRF token",
                "level": 2,
                "parameter": "",
                "referer": "http://csrf/unprotected_form.php",
                "module": "csrf",
                "http_request": "POST /csrf_verify_unprotected.php HTTP/1.1\nhost: csrf\nconnection: keep-alive\nuser-agent: Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0\naccept-language: en-US\naccept-encoding: gzip, deflate, br\naccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\ncontent-type: application/x-www-form-urlencoded\nreferer: http://csrf/unprotected_form.php\ncookie: PHPSESSID=1335df1b1b4a2149e8690c7ce5\ncontent-length: 12\nContent-Type: application/x-www-form-urlencoded\n\nname=default",
                "curl_command": "curl \"http://csrf/csrf_verify_unprotected.php\" -e \"http://csrf/unprotected_form.php\" -d \"name=default\"",
                "wstg": [
                    "WSTG-SESS-05"
                ],
                "detail": {
                    "response": null
                }
            },
            {
                "method": "POST",
                "path": "/fake_protected_form.php",
                "info": "CSRF token 'csrf_token' might be easy to predict",
                "level": 2,
                "parameter": "",
                "referer": "http://csrf/fake_protected_form.php",
                "module": "csrf",
                "http_request": "POST /fake_protected_form.php HTTP/1.1\ncontent-type: application/x-www-form-urlencoded, application/x-www-form-urlencoded\nhost: csrf\nconnection: keep-alive\nuser-agent: Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0\naccept-language: en-US\naccept-encoding: gzip, deflate, br\naccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nreferer: http://csrf/fake_protected_form.php\ncookie: PHPSESSID=1335df1b1b4a214\ncontent-length: 39\nContent-Type: application/x-www-form-urlencoded\n\ncsrf_token=AAAAAAAAAAAAAAA&name=default",
                "curl_command": "curl \"http://csrf/fake_protected_form.php\" -e \"http://csrf/fake_protected_form.php\" -d \"csrf_token=AAAAAAAAAAAAAAA&name=default\"",
                "wstg": [
                    "WSTG-SESS-05"
                ],
                "detail": {
                    "response": null
                }
            }
        ],
        "Potentially dangerous file": [],
        "Command execution": [],
        "Path Traversal": [],
        "Fingerprint web application framework": [],
        "Fingerprint web server": [],
        "Htaccess Bypass": [],
        "HTTP Secure Headers": [],
        "HttpOnly Flag cookie": [],
        "Log4Shell": [],
        "Open Redirect": [],
        "Reflected Cross Site Scripting": [],
        "Secure Flag cookie": [],
        "SQL Injection": [],
        "TLS/SSL misconfigurations": [],
        "Server Side Request Forgery": [],
        "Stored Cross Site Scripting": [],
        "Subdomain takeover": [],
        "Blind SQL Injection": [],
        "XML External Entity": []
    },
    "anomalies": {
        "Internal Server Error": [],
        "Resource consumption": []
    },
    "additionnals": {},
    "infos": {
        "target": "http://csrf/",
        "version": "Wapiti 3.1.7",
        "scope": "folder",
        "auth": null,
        "crawled_pages_nbr": 8,
        "crawled_pages": [
            {
                "request": {
                    "url": "http://csrf/",
                    "method": "GET",
                    "headers": [
                        [
                            "host",
                            "csrf"
                        ],
                        [
                            "connection",
                            "keep-alive"
                        ],
                        [
                            "user-agent",
                            "Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0"
                        ],
                        [
                            "accept-language",
                            "en-US"
                        ],
                        [
                            "accept-encoding",
                            "gzip, deflate, br"
                        ],
                        [
                            "accept",
                            "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
                        ]
                    ],
                    "referer": "",
                    "enctype": "",
                    "encoding": "UTF-8",
                    "depth": 0
                },
                "response": {
                    "status_code": 200,
                    "body": "<!DOCTYPE html>\n<html>\n<head>\n\t<title>Index</title>\n</head>\n<body>\n\t<h1>Index</h1>\n\t<p>This is a simple PHP web page.</p>\n    <ul>\n        <li><a href=\"unprotected_form.php\">unprotected form</a></li>\n        <li><a href=\"protected_form.php\">protected form</a></li>\n        <li><a href=\"fake_protected_form.php\">weak protected form</a></li> \n    </ul>\n</body>\n</html>\n",
                    "headers": [
                        [
                            "server",
                            "Apache/2.4.56 (Debian)"
                        ],
                        [
                            "x-powered-by",
                            "PHP/8.1.18"
                        ],
                        [
                            "vary",
                            "Accept-Encoding"
                        ],
                        [
                            "content-encoding",
                            "gzip"
                        ],
                        [
                            "content-length",
                            "198"
                        ],
                        [
                            "keep-alive",
                            "timeout=5, max=100"
                        ],
                        [
                            "connection",
                            "Keep-Alive"
                        ],
                        [
                            "content-type",
                            "text/html; charset=UTF-8"
                        ]
                    ]
                }
            },
            {
                "request": {
                    "url": "http://csrf/fake_protected_form.php",
                    "method": "GET",
                    "headers": [
                        [
                            "host",
                            "csrf"
                        ],
                        [
                            "connection",
                            "keep-alive"
                        ],
                        [
                            "user-agent",
                            "Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0"
                        ],
                        [
                            "accept-language",
                            "en-US"
                        ],
                        [
                            "accept-encoding",
                            "gzip, deflate, br"
                        ],
                        [
                            "accept",
                            "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
                        ]
                    ],
                    "referer": "",
                    "enctype": "",
                    "encoding": "UTF-8",
                    "depth": 1
                },
                "response": {
                    "status_code": 200,
                    "body": "<!DOCTYPE html><html><head>\t<meta charset=\"UTF-8\">\t<title>CSRF protected test</title></head><body>    <form method=\"POST\">    <label for=\"name\">Name:</label>    <input type=\"hidden\" name=\"csrf_token\" value=\"AAAAAAAAAAAAAAA\">    <input type=\"text\" id=\"name\" name=\"name\"><br><br>    <input type=\"submit\" value=\"Update\">    </form></body></html>",
                    "headers": [
                        [
                            "server",
                            "Apache/2.4.56 (Debian)"
                        ],
                        [
                            "x-powered-by",
                            "PHP/8.1.18"
                        ],
                        [
                            "set-cookie",
                            "PHPSESSID=1335df1b1b4a214; path=/"
                        ],
                        [
                            "expires",
                            "Thu, 19 Nov 1981 08:52:00 GMT"
                        ],
                        [
                            "cache-control",
                            "no-store, no-cache, must-revalidate"
                        ],
                        [
                            "pragma",
                            "no-cache"
                        ],
                        [
                            "vary",
                            "Accept-Encoding"
                        ],
                        [
                            "content-encoding",
                            "gzip"
                        ],
                        [
                            "content-length",
                            "226"
                        ],
                        [
                            "keep-alive",
                            "timeout=5, max=99"
                        ],
                        [
                            "connection",
                            "Keep-Alive"
                        ],
                        [
                            "content-type",
                            "text/html; charset=UTF-8"
                        ]
                    ]
                }
            },
            {
                "request": {
                    "url": "http://csrf/fake_protected_form.php",
                    "method": "POST",
                    "headers": [
                        [
                            "host",
                            "csrf"
                        ],
                        [
                            "connection",
                            "keep-alive"
                        ],
                        [
                            "user-agent",
                            "Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0"
                        ],
                        [
                            "accept-language",
                            "en-US"
                        ],
                        [
                            "accept-encoding",
                            "gzip, deflate, br"
                        ],
                        [
                            "accept",
                            "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
                        ],
                        [
                            "content-type",
                            "application/x-www-form-urlencoded"
                        ],
                        [
                            "referer",
                            "http://csrf/fake_protected_form.php"
                        ],
                        [
                            "cookie",
                            "PHPSESSID=1335df1b1b4a214"
                        ],
                        [
                            "content-length",
                            "39"
                        ]
                    ],
                    "referer": "http://csrf/fake_protected_form.php",
                    "enctype": "application/x-www-form-urlencoded",
                    "encoding": "utf-8",
                    "depth": 2
                },
                "response": {
                    "status_code": 200,
                    "body": "<!DOCTYPE html><html><head>\t<meta charset=\"UTF-8\">\t<title>CSRF protected test</title></head><body>    <form method=\"POST\">    <label for=\"name\">Name:</label>    <input type=\"hidden\" name=\"csrf_token\" value=\"AAAAAAAAAAAAAAA\">    <input type=\"text\" id=\"name\" name=\"name\"><br><br>    <input type=\"submit\" value=\"Update\">    </form></body></html>form submitted !",
                    "headers": [
                        [
                            "server",
                            "Apache/2.4.56 (Debian)"
                        ],
                        [
                            "x-powered-by",
                            "PHP/8.1.18"
                        ],
                        [
                            "set-cookie",
                            "PHPSESSID=1335df1b1b4a214; path=/"
                        ],
                        [
                            "expires",
                            "Thu, 19 Nov 1981 08:52:00 GMT"
                        ],
                        [
                            "cache-control",
                            "no-store, no-cache, must-revalidate"
                        ],
                        [
                            "pragma",
                            "no-cache"
                        ],
                        [
                            "vary",
                            "Accept-Encoding"
                        ],
                        [
                            "content-encoding",
                            "gzip"
                        ],
                        [
                            "content-length",
                            "232"
                        ],
                        [
                            "keep-alive",
                            "timeout=5, max=98"
                        ],
                        [
                            "connection",
                            "Keep-Alive"
                        ],
                        [
                            "content-type",
                            "text/html; charset=UTF-8"
                        ]
                    ]
                }
            },
            {
                "request": {
                    "url": "http://csrf/protected_form.php",
                    "method": "GET",
                    "headers": [
                        [
                            "host",
                            "csrf"
                        ],
                        [
                            "connection",
                            "keep-alive"
                        ],
                        [
                            "user-agent",
                            "Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0"
                        ],
                        [
                            "accept-language",
                            "en-US"
                        ],
                        [
                            "accept-encoding",
                            "gzip, deflate, br"
                        ],
                        [
                            "accept",
                            "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
                        ]
                    ],
                    "referer": "",
                    "enctype": "",
                    "encoding": "UTF-8",
                    "depth": 1
                },
                "response": {
                    "status_code": 200,
                    "body": "<!DOCTYPE html><html><head>\t<meta charset=\"UTF-8\">\t<title>CSRF protected test</title></head><body>    <form method=\"POST\">    <label for=\"name\">Name:</label>    <input type=\"hidden\" name=\"csrf_token\" value=\"9043822b789c44d72175a57b4ae35aace401ae0c7384d6588aeaee3b9302eb71\">    <input type=\"text\" id=\"name\" name=\"name\"><br><br>    <input type=\"submit\" value=\"Update\">    </form></body></html>",
                    "headers": [
                        [
                            "server",
                            "Apache/2.4.56 (Debian)"
                        ],
                        [
                            "x-powered-by",
                            "PHP/8.1.18"
                        ],
                        [
                            "set-cookie",
                            "PHPSESSID=1335df1b1b4a2149e8690c7ce5fc3932; path=/"
                        ],
                        [
                            "expires",
                            "Thu, 19 Nov 1981 08:52:00 GMT"
                        ],
                        [
                            "cache-control",
                            "no-store, no-cache, must-revalidate"
                        ],
                        [
                            "pragma",
                            "no-cache"
                        ],
                        [
                            "vary",
                            "Accept-Encoding"
                        ],
                        [
                            "content-encoding",
                            "gzip"
                        ],
                        [
                            "content-length",
                            "274"
                        ],
                        [
                            "keep-alive",
                            "timeout=5, max=100"
                        ],
                        [
                            "connection",
                            "Keep-Alive"
                        ],
                        [
                            "content-type",
                            "text/html; charset=UTF-8"
                        ]
                    ]
                }
            },
            {
                "request": {
                    "url": "http://csrf/unprotected_form.php",
                    "method": "GET",
                    "headers": [
                        [
                            "host",
                            "csrf"
                        ],
                        [
                            "connection",
                            "keep-alive"
                        ],
                        [
                            "user-agent",
                            "Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0"
                        ],
                        [
                            "accept-language",
                            "en-US"
                        ],
                        [
                            "accept-encoding",
                            "gzip, deflate, br"
                        ],
                        [
                            "accept",
                            "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
                        ]
                    ],
                    "referer": "",
                    "enctype": "",
                    "encoding": "UTF-8",
                    "depth": 1
                },
                "response": {
                    "status_code": 200,
                    "body": "<!DOCTYPE html>\n<html>\n<head>\n\t<meta charset=\"UTF-8\">\n\t<title>CSRF unprotected test</title>\n</head>\n<body>\n    <form action=\"csrf_verify_unprotected.php\" method=\"post\">\n    <label for=\"name\">Name:</label>\n    <input type=\"text\" id=\"name\" name=\"name\"><br><br>\n    <input type=\"submit\" value=\"Update\">\n    </form>\n</body>\n</html>\n\n",
                    "headers": [
                        [
                            "server",
                            "Apache/2.4.56 (Debian)"
                        ],
                        [
                            "x-powered-by",
                            "PHP/8.1.18"
                        ],
                        [
                            "set-cookie",
                            "PHPSESSID=1335df1b1b4a2149e8690c7ce5; path=/"
                        ],
                        [
                            "expires",
                            "Thu, 19 Nov 1981 08:52:00 GMT"
                        ],
                        [
                            "cache-control",
                            "no-store, no-cache, must-revalidate"
                        ],
                        [
                            "pragma",
                            "no-cache"
                        ],
                        [
                            "vary",
                            "Accept-Encoding"
                        ],
                        [
                            "content-encoding",
                            "gzip"
                        ],
                        [
                            "content-length",
                            "230"
                        ],
                        [
                            "keep-alive",
                            "timeout=5, max=100"
                        ],
                        [
                            "connection",
                            "Keep-Alive"
                        ],
                        [
                            "content-type",
                            "text/html; charset=UTF-8"
                        ]
                    ]
                }
            },
            {
                "request": {
                    "url": "http://csrf/protected_form.php",
                    "method": "POST",
                    "headers": [
                        [
                            "host",
                            "csrf"
                        ],
                        [
                            "connection",
                            "keep-alive"
                        ],
                        [
                            "user-agent",
                            "Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0"
                        ],
                        [
                            "accept-language",
                            "en-US"
                        ],
                        [
                            "accept-encoding",
                            "gzip, deflate, br"
                        ],
                        [
                            "accept",
                            "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
                        ],
                        [
                            "content-type",
                            "application/x-www-form-urlencoded"
                        ],
                        [
                            "referer",
                            "http://csrf/protected_form.php"
                        ],
                        [
                            "cookie",
                            "PHPSESSID=1335df1b1b4a2149e8690c7ce5"
                        ],
                        [
                            "content-length",
                            "88"
                        ]
                    ],
                    "referer": "http://csrf/protected_form.php",
                    "enctype": "application/x-www-form-urlencoded",
                    "encoding": "utf-8",
                    "depth": 2
                },
                "response": {
                    "status_code": 200,
                    "body": "<!DOCTYPE html><html><head>\t<meta charset=\"UTF-8\">\t<title>CSRF protected test</title></head><body>    <form method=\"POST\">    <label for=\"name\">Name:</label>    <input type=\"hidden\" name=\"csrf_token\" value=\"9043822b789c44d72175a57b4ae35aace401ae0c7384d6588aeaee3b9302eb71\">    <input type=\"text\" id=\"name\" name=\"name\"><br><br>    <input type=\"submit\" value=\"Update\">    </form></body></html>form submitted !",
                    "headers": [
                        [
                            "server",
                            "Apache/2.4.56 (Debian)"
                        ],
                        [
                            "x-powered-by",
                            "PHP/8.1.18"
                        ],
                        [
                            "set-cookie",
                            "PHPSESSID=1335df1b1b4a2149e8690c7ce5fc3932; path=/"
                        ],
                        [
                            "expires",
                            "Thu, 19 Nov 1981 08:52:00 GMT"
                        ],
                        [
                            "cache-control",
                            "no-store, no-cache, must-revalidate"
                        ],
                        [
                            "pragma",
                            "no-cache"
                        ],
                        [
                            "vary",
                            "Accept-Encoding"
                        ],
                        [
                            "content-encoding",
                            "gzip"
                        ],
                        [
                            "content-length",
                            "280"
                        ],
                        [
                            "keep-alive",
                            "timeout=5, max=97"
                        ],
                        [
                            "connection",
                            "Keep-Alive"
                        ],
                        [
                            "content-type",
                            "text/html; charset=UTF-8"
                        ]
                    ]
                }
            },
            {
                "request": {
                    "url": "http://csrf/csrf_verify_unprotected.php",
                    "method": "GET",
                    "headers": [
                        [
                            "host",
                            "csrf"
                        ],
                        [
                            "connection",
                            "keep-alive"
                        ],
                        [
                            "user-agent",
                            "Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0"
                        ],
                        [
                            "accept-language",
                            "en-US"
                        ],
                        [
                            "accept-encoding",
                            "gzip, deflate, br"
                        ],
                        [
                            "accept",
                            "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
                        ],
                        [
                            "cookie",
                            "PHPSESSID=1335df1b1b4a2149e8690c7ce5"
                        ]
                    ],
                    "referer": "",
                    "enctype": "",
                    "encoding": "UTF-8",
                    "depth": 2
                },
                "response": {
                    "status_code": 404,
                    "body": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\n<html><head>\n<title>404 Not Found</title>\n</head><body>\n<h1>Not Found</h1>\n<p>The requested URL was not found on this server.</p>\n<hr>\n<address>Apache/2.4.56 (Debian) Server at csrf Port 80</address>\n</body></html>\n",
                    "headers": [
                        [
                            "server",
                            "Apache/2.4.56 (Debian)"
                        ],
                        [
                            "content-length",
                            "266"
                        ],
                        [
                            "keep-alive",
                            "timeout=5, max=99"
                        ],
                        [
                            "connection",
                            "Keep-Alive"
                        ],
                        [
                            "content-type",
                            "text/html; charset=iso-8859-1"
                        ]
                    ]
                }
            },
            {
                "request": {
                    "url": "http://csrf/csrf_verify_unprotected.php",
                    "method": "POST",
                    "headers": [
                        [
                            "host",
                            "csrf"
                        ],
                        [
                            "connection",
                            "keep-alive"
                        ],
                        [
                            "user-agent",
                            "Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0"
                        ],
                        [
                            "accept-language",
                            "en-US"
                        ],
                        [
                            "accept-encoding",
                            "gzip, deflate, br"
                        ],
                        [
                            "accept",
                            "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
                        ],
                        [
                            "content-type",
                            "application/x-www-form-urlencoded"
                        ],
                        [
                            "referer",
                            "http://csrf/unprotected_form.php"
                        ],
                        [
                            "cookie",
                            "PHPSESSID=1335df1b1b4a2149e8690c7ce5"
                        ],
                        [
                            "content-length",
                            "12"
                        ]
                    ],
                    "referer": "http://csrf/unprotected_form.php",
                    "enctype": "application/x-www-form-urlencoded",
                    "encoding": "utf-8",
                    "depth": 2
                },
                "response": {
                    "status_code": 404,
                    "body": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\n<html><head>\n<title>404 Not Found</title>\n</head><body>\n<h1>Not Found</h1>\n<p>The requested URL was not found on this server.</p>\n<hr>\n<address>Apache/2.4.56 (Debian) Server at csrf Port 80</address>\n</body></html>\n",
                    "headers": [
                        [
                            "server",
                            "Apache/2.4.56 (Debian)"
                        ],
                        [
                            "content-length",
                            "266"
                        ],
                        [
                            "keep-alive",
                            "timeout=5, max=99"
                        ],
                        [
                            "connection",
                            "Keep-Alive"
                        ],
                        [
                            "content-type",
                            "text/html; charset=iso-8859-1"
                        ]
                    ]
                }
            }
        ],
        "detailed_report": true
    }
}